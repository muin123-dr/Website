<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pengingat Ibadah Harian</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --primary: #2c786c;
            --secondary: #ff9800;
            --accent: #004445;
            --light: #f8f9fa;
            --dark: #343a40;
            --success: #28a745;
            --danger: #dc3545;
            --warning: #ffc107;
            --info: #17a2b8;
            --gold: #ffd700;
            --text-light: #ffffff;
            --text-yellow: #fff176;
            --text-gold: #ffd54f;
        }

        body {
            background: linear-gradient(135deg, #1a3a3a 0%, #2c786c 50%, #004445 100%);
            color: var(--dark);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            text-align: center;
            border: 3px solid var(--accent);
        }

        .header h1 {
            color: var(--primary);
            margin-bottom: 10px;
            font-size: 1.8rem;
        }

        .header p {
            color: #666;
            margin-bottom: 20px;
            font-size: 0.9rem;
        }

        .time-display {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 12px;
            margin-bottom: 20px;
        }

        .time-card {
            background: var(--primary);
            color: var(--text-light);
            padding: 12px 15px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .time-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.15);
        }

        .time-card h3 {
            font-size: 0.75rem;
            margin-bottom: 5px;
            color: var(--text-yellow);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 600;
        }

        .time-card p {
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--text-light);
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        }

        .time-card .location-text {
            font-size: 0.85rem;
            color: #e8f5e9;
            font-weight: 500;
            min-height: 1.2rem;
        }

        .time-card .date-text {
            font-size: 0.9rem;
            color: #ffffff;
            font-weight: 600;
        }

        .time-card .day-text {
            font-size: 0.8rem;
            color: #bbdefb;
            font-weight: 500;
        }

        /* Waktu saat ini - lebih menonjol */
        .time-card.current-time {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            border: 2px solid var(--gold);
            box-shadow: 0 5px 15px rgba(255, 215, 0, 0.3);
            animation: glow 2s infinite alternate;
        }

        @keyframes glow {
            from {
                box-shadow: 0 5px 15px rgba(255, 215, 0, 0.3);
            }
            to {
                box-shadow: 0 5px 20px rgba(255, 215, 0, 0.5);
            }
        }

        .time-card.current-time h3 {
            color: var(--text-gold);
            font-size: 0.8rem;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
        }

        .time-card.current-time p {
            font-size: 1.4rem;
            font-weight: bold;
            color: #ffffff;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.4);
        }

        #hijri-date {
            background: var(--accent);
        }

        #hijri-date h3 {
            color: #ffecb3;
        }

        #hijri-date p {
            color: #fff9c4;
            font-weight: 600;
        }

        .location-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }

        .location-btn {
            background: var(--secondary);
            color: white;
            border: none;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.7rem;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 3px;
            font-weight: 500;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .location-btn:hover {
            background: #e68900;
            transform: scale(1.05);
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.25);
        }

        .location-btn:active {
            transform: scale(0.95);
        }

        .location-btn i {
            margin-right: 3px;
        }

        .highlight-box {
            background: linear-gradient(to right, #ff9800, #ff5722);
            color: white;
            padding: 15px;
            border-radius: 15px;
            margin: 20px 0;
            text-align: center;
            animation: pulse 2s infinite;
            box-shadow: 0 8px 25px rgba(255, 152, 0, 0.3);
            border: 2px solid white;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }

        .highlight-box h2 {
            font-size: 1.4rem;
            margin-bottom: 8px;
            color: #fff;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .highlight-box p {
            font-size: 1rem;
            opacity: 0.95;
            color: #fffde7;
            font-weight: 500;
        }

        .content {
            display: grid;
            grid-template-columns: 1fr;
            gap: 25px;
        }

        @media (min-width: 992px) {
            .content {
                grid-template-columns: 2fr 1fr;
            }
        }

        .ibadah-list {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            max-height: 600px;
            overflow-y: auto;
        }

        .ibadah-list h2 {
            color: var(--primary);
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 3px solid var(--secondary);
            font-size: 1.6rem;
        }

        .ibadah-item {
            display: flex;
            align-items: center;
            padding: 15px;
            margin-bottom: 12px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
            border-left: 5px solid var(--primary);
        }

        .ibadah-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            border-left-color: var(--secondary);
        }

        .ibadah-item.important {
            background: linear-gradient(to right, #fff8e1, #ffecb3);
            border-left-color: var(--warning);
        }

        .ibadah-item.urgent {
            background: linear-gradient(to right, #ffebee, #ffcdd2);
            border-left-color: var(--danger);
            animation: urgent-pulse 1.5s infinite;
        }

        @keyframes urgent-pulse {
            0% { box-shadow: 0 0 0 0 rgba(220, 53, 69, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(220, 53, 69, 0); }
            100% { box-shadow: 0 0 0 0 rgba(220, 53, 69, 0); }
        }

        .ibadah-number {
            background: var(--primary);
            color: white;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 15px;
            flex-shrink: 0;
            font-size: 0.9rem;
        }

        .ibadah-info {
            flex: 1;
        }

        .ibadah-name {
            font-weight: bold;
            font-size: 1.1rem;
            color: var(--dark);
            margin-bottom: 5px;
        }

        .ibadah-time {
            color: #666;
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .ibadah-time i {
            color: var(--primary);
        }

        .checkmark {
            width: 26px;
            height: 26px;
            border: 2px solid #ddd;
            border-radius: 50%;
            cursor: pointer;
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
            margin-left: 10px;
        }

        .checkmark.checked {
            background: var(--success);
            border-color: var(--success);
        }

        .checkmark.checked::after {
            content: "✓";
            color: white;
            font-weight: bold;
        }

        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }

        .next-ibadah {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .next-ibadah h3 {
            color: var(--primary);
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid var(--secondary);
            font-size: 1.2rem;
        }

        .next-item {
            background: white;
            padding: 12px;
            border-radius: 10px;
            margin-bottom: 12px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
            border-left: 4px solid var(--info);
        }

        .next-time {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--accent);
            margin-bottom: 5px;
        }

        .next-name {
            font-weight: bold;
            color: var(--dark);
            font-size: 0.95rem;
        }

        .progress-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .progress-container h3 {
            color: var(--primary);
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid var(--secondary);
            font-size: 1.2rem;
        }

        .progress-bar {
            height: 22px;
            background: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 15px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(to right, var(--primary), var(--accent));
            border-radius: 10px;
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 0.85rem;
        }

        .progress-stats {
            display: flex;
            justify-content: space-between;
            font-weight: bold;
            color: var(--dark);
            font-size: 0.9rem;
        }

        .footer {
            text-align: center;
            color: white;
            margin-top: 25px;
            padding: 15px;
            opacity: 0.8;
            font-size: 0.85rem;
        }

        /* Scrollbar styling */
        .ibadah-list::-webkit-scrollbar {
            width: 6px;
        }

        .ibadah-list::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 8px;
        }

        .ibadah-list::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 8px;
        }

        .ibadah-list::-webkit-scrollbar-thumb:hover {
            background: var(--accent);
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--success);
            color: white;
            padding: 12px 20px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            transform: translateX(150%);
            transition: transform 0.5s ease;
            z-index: 1000;
            font-size: 0.9rem;
        }

        .notification.show {
            transform: translateX(0);
        }

        .loading {
            font-size: 0.8rem;
            color: #e0f7fa;
            font-style: italic;
        }

        .location-loading {
            color: #bbdefb;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-mosque"></i> Pengingat Ibadah Harian</h1>
            <p>Berdasarkan waktu real-time dan jadwal ibadah harian</p>
            
            <div class="time-display">
                <div class="time-card">
                    <h3><i class="fas fa-map-marker-alt"></i> Lokasi</h3>
                    <div class="location-container">
                        <p id="location" class="location-text">Jakarta, Indonesia</p>
                        <button class="location-btn" id="get-location-btn">
                            <i class="fas fa-location-crosshairs"></i> Dapatkan Lokasi
                        </button>
                    </div>
                </div>
                <div class="time-card">
                    <h3><i class="fas fa-calendar-day"></i> Tanggal</h3>
                    <p id="date" class="date-text">7 Feb 2026</p>
                    <p id="day" class="day-text">Sabtu</p>
                </div>
                <div class="time-card" id="hijri-date">
                    <h3><i class="fas fa-moon"></i> Hijriyah</h3>
                    <p id="hijri" class="date-text">Memuat...</p>
                </div>
                <div class="time-card current-time">
                    <h3><i class="fas fa-clock"></i> Waktu Saat Ini</h3>
                    <p id="time">04:30:00</p>
                </div>
            </div>
        </div>

        <div id="highlight-box" class="highlight-box" style="display: none;">
            <h2 id="highlight-title">WAKTU UTAMA IBADAH</h2>
            <p id="highlight-text">Saat ini adalah waktu utama untuk beberapa ibadah penting</p>
        </div>

        <div class="content">
            <div class="ibadah-list">
                <h2><i class="fas fa-tasks"></i> IBADAH YANG BISA ANDA LAKUKAN SAAT INI</h2>
                <div id="ibadah-container">
                    <!-- Ibadah akan dimuat disini secara dinamis -->
                </div>
            </div>

            <div class="sidebar">
                <div class="next-ibadah">
                    <h3><i class="fas fa-calendar-check"></i> Ibadah Berikutnya</h3>
                    <div id="next-ibadah-container">
                        <!-- Ibadah berikutnya akan dimuat disini -->
                    </div>
                </div>

                <div class="progress-container">
                    <h3><i class="fas fa-chart-line"></i> Progress Hari Ini</h3>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-fill">0%</div>
                    </div>
                    <div class="progress-stats">
                        <span id="completed">0</span> selesai dari <span id="total">0</span> ibadah
                    </div>
                </div>
            </div>
        </div>

        <div class="footer">
            <p>© 2024 Pengingat Ibadah Harian | Update real-time setiap detik | Semoga menjadi pengingat kebaikan</p>
            <p style="margin-top: 5px; font-size: 0.75rem; color: #bbdefb;">Tanggal Hijriyah dari IslamicFinder.org</p>
        </div>
    </div>

    <div class="notification" id="notification">
        Ibadah telah dicentang!
    </div>

    <script>
        // Data ibadah berdasarkan waktu
        const ibadahData = {
            // Sebelum Subuh (00:00 - 04:30)
            "beforeFajr": [
                { id: 1, name: "Baca Al-Qur'an", time: "24 jam sehari", important: true, category: "umum" },
                { id: 2, name: "Dzikir & Istighfar", time: "24 jam sehari", important: true, category: "umum" },
                { id: 28, name: "Sholat Tahajud", time: "Setelah tidur - sebelum Subuh", important: true, category: "malam", urgent: true },
                { id: 29, name: "Sholat Witir", time: "Setelah Isya - sebelum Subuh", important: true, category: "malam", urgent: true },
                { id: 32, name: "Doa sepertiga malam", time: "Sepertiga malam terakhir", important: true, category: "malam", urgent: true },
                { id: 33, name: "Sholat Taubat", time: "Setelah menyesal dari dosa", important: false, category: "umum" },
                { id: 68, name: "Doa sebelum tidur", time: "Sebelum tidur", important: false, category: "harian" }
            ],
            
            // Subuh (04:30 - 06:00)
            "fajr": [
                { id: 1, name: "Baca Al-Qur'an", time: "Utama setelah Subuh", important: true, category: "umum", urgent: true },
                { id: 11, name: "Sholat Qobliyah Subuh", time: "Sebelum Subuh", important: true, category: "rawatib", urgent: true },
                { id: 12, name: "Sholat Subuh", time: "Setelah adzan Subuh", important: true, category: "wajib", urgent: true },
                { id: 13, name: "Dzikir pagi", time: "Ba'da Subuh", important: true, category: "dzikir", urgent: true },
                { id: 37, name: "Doa setelah sholat wajib", time: "Ba'da salam", important: true, category: "doa" },
                { id: 65, name: "Tasbih, Tahmid, Takbir", time: "Ba'da sholat", important: false, category: "dzikir" }
            ],
            
            // Pagi (06:00 - 10:30)
            "morning": [
                { id: 1, name: "Baca Al-Qur'an", time: "24 jam sehari", important: true, category: "umum" },
                { id: 14, name: "Sholat Isyraq", time: "±15 menit setelah matahari terbit", important: false, category: "sunnah" },
                { id: 15, name: "Sholat Dhuha", time: "07.00 - sebelum Dzuhur", important: true, category: "sunnah" },
                { id: 6, name: "Sedekah", time: "24 jam sehari", important: false, category: "umum" },
                { id: 7, name: "Birrul walidain", time: "24 jam sehari", important: false, category: "umum" },
                { id: 9, name: "Menuntut ilmu", time: "24 jam sehari", important: false, category: "umum" }
            ],
            
            // Dzuhur (10:30 - 15:30)
            "dhuhr": [
                { id: 1, name: "Baca Al-Qur'an", time: "24 jam sehari", important: false, category: "umum" },
                { id: 16, name: "Sholat Qobliyah Dzuhur", time: "Sebelum Dzuhur", important: true, category: "rawatib", urgent: true },
                { id: 17, name: "Sholat Dzuhur", time: "Setelah matahari tergelincir", important: true, category: "wajib", urgent: true },
                { id: 18, name: "Sholat Ba'diyah Dzuhur", time: "Setelah Dzuhur", important: true, category: "rawatib" },
                { id: 37, name: "Doa setelah sholat wajib", time: "Ba'da salam", important: true, category: "doa" },
                { id: 35, name: "Doa antara adzan–iqamah", time: "Setelah adzan sebelum iqamah", important: false, category: "doa" }
            ],
            
            // Ashar (15:30 - 18:00)
            "asr": [
                { id: 1, name: "Baca Al-Qur'an", time: "24 jam sehari", important: false, category: "umum" },
                { id: 19, name: "Sholat Ashar", time: "Setelah masuk Ashar", important: true, category: "wajib", urgent: true },
                { id: 20, name: "Dzikir petang", time: "Ba'da Ashar", important: true, category: "dzikir", urgent: true },
                { id: 37, name: "Doa setelah sholat wajib", time: "Ba'da salam", important: true, category: "doa" },
                { id: 8, name: "Silaturahmi", time: "24 jam sehari", important: false, category: "umum" }
            ],
            
            // Maghrib (18:00 - 19:30)
            "maghrib": [
                { id: 1, name: "Baca Al-Qur'an", time: "Utama setelah Maghrib", important: true, category: "umum", urgent: true },
                { id: 21, name: "Sholat Qobliyah Maghrib", time: "Sebelum Maghrib (singkat)", important: false, category: "rawatib" },
                { id: 22, name: "Sholat Maghrib", time: "Setelah adzan Maghrib", important: true, category: "wajib", urgent: true },
                { id: 23, name: "Sholat Ba'diyah Maghrib", time: "Setelah Maghrib", important: true, category: "rawatib" },
                { id: 24, name: "Sholat Awwabin", time: "Antara Maghrib - Isya", important: false, category: "sunnah" },
                { id: 37, name: "Doa setelah sholat wajib", time: "Ba'da salam", important: true, category: "doa" },
                { id: 40, name: "Doa ketika berbuka puasa", time: "Saat Maghrib (berbuka)", important: true, category: "doa", urgent: true }
            ],
            
            // Isya (19:30 - 23:59)
            "isha": [
                { id: 1, name: "Baca Al-Qur'an", time: "24 jam sehari", important: false, category: "umum" },
                { id: 25, name: "Sholat Qobliyah Isya", time: "Sebelum Isya", important: false, category: "rawatib" },
                { id: 26, name: "Sholat Isya", time: "Setelah adzan Isya", important: true, category: "wajib", urgent: true },
                { id: 27, name: "Sholat Ba'diyah Isya", time: "Setelah Isya", important: true, category: "rawatib" },
                { id: 29, name: "Sholat Witir", time: "Setelah Isya", important: true, category: "malam" },
                { id: 37, name: "Doa setelah sholat wajib", time: "Ba'da salam", important: true, category: "doa" },
                { id: 67, name: "Doa masuk rumah", time: "Saat masuk rumah", important: false, category: "doa" },
                { id: 68, name: "Doa sebelum tidur", time: "Sebelum tidur", important: false, category: "doa" }
            ]
        };

        // Ibadah yang selalu bisa dilakukan
        const alwaysIbadah = [
            { id: 1, name: "Baca Al-Qur'an", time: "24 jam sehari", important: true, category: "umum" },
            { id: 2, name: "Dzikir & Istighfar", time: "24 jam sehari", important: true, category: "umum" },
            { id: 4, name: "Sholawat Nabi", time: "24 jam sehari", important: true, category: "umum" },
            { id: 5, name: "Doa", time: "24 jam sehari", important: false, category: "umum" },
            { id: 6, name: "Sedekah", time: "24 jam sehari", important: false, category: "umum" },
            { id: 7, name: "Birrul walidain", time: "24 jam sehari", important: false, category: "umum" },
            { id: 8, name: "Silaturahmi", time: "24 jam sehari", important: false, category: "umum" },
            { id: 9, name: "Menuntut ilmu", time: "24 jam sehari", important: false, category: "umum" },
            { id: 10, name: "Amar ma'ruf nahi munkar", time: "24 jam sehari", important: false, category: "umum" }
        ];

        // Waktu ibadah berikutnya
        const nextIbadahSchedule = [
            { time: "04:30", name: "Sholat Subuh", period: "Subuh" },
            { time: "07:00", name: "Sholat Dhuha", period: "Pagi" },
            { time: "12:00", name: "Sholat Dzuhur", period: "Siang" },
            { time: "15:30", name: "Sholat Ashar", period: "Sore" },
            { time: "18:00", name: "Sholat Maghrib", period: "Petang" },
            { time: "19:30", name: "Sholat Isya", period: "Malam" },
            { time: "23:00", name: "Sholat Tahajud", period: "Malam" }
        ];

        // Waktu highlight khusus
        const highlightTimes = [
            { start: "03:00", end: "05:00", title: "SEPERTIGA MALAM TERAKHIR", text: "Waktu mustajab untuk doa, tahajud, dan istighfar" },
            { start: "04:30", end: "06:00", title: "WAKTU SUBUH", text: "Waktu utama membaca Quran, dzikir pagi, dan sholat sunnah" },
            { start: "12:00", end: "13:00", title: "WAKTU DZUHUR", text: "Sholat berjamaah dan doa antara adzan-iqamah" },
            { start: "15:30", end: "17:00", title: "WAKTU ASHAR", text: "Dzikir petang dan menjaga sholat Ashar" },
            { start: "18:00", end: "19:00", title: "WAKTU MAGHRIB", text: "Waktu mustajab doa dan utama membaca Quran" },
            { start: "19:30", end: "20:30", title: "WAKTU ISYA", text: "Sholat berjamaah dan witir" },
            { start: "07:00", end: "10:30", title: "WAKTU DHUHA", text: "Sholat Dhuha dan sedekah" }
        ];

        // Simpan ibadah yang sudah dicentang
        let completedIbadah = JSON.parse(localStorage.getItem('completedIbadah')) || [];
        
        // Update waktu real-time
        function updateTime() {
            const now = new Date();
            
            // Format waktu
            const timeOptions = { hour: '2-digit', minute: '2-digit', second: '2-digit' };
            const dateOptions = { day: 'numeric', month: 'short', year: 'numeric' };
            const dayOptions = { weekday: 'long' };
            
            // Update elemen waktu
            document.getElementById('time').textContent = now.toLocaleTimeString('id-ID', timeOptions);
            document.getElementById('date').textContent = now.toLocaleDateString('id-ID', dateOptions);
            document.getElementById('day').textContent = now.toLocaleDateString('id-ID', dayOptions);
            
            // Update tanggal Hijriyah
            updateHijriDate(now);
            
            // Tentukan periode waktu saat ini
            const currentHour = now.getHours();
            const currentMinute = now.getMinutes();
            const currentTimeStr = `${currentHour.toString().padStart(2, '0')}:${currentMinute.toString().padStart(2, '0')}`;
            
            // Tentukan ibadah berdasarkan waktu
            let currentIbadah = [];
            let timePeriod = "";
            
            if (currentHour >= 0 && currentHour < 4.5) {
                currentIbadah = [...ibadahData.beforeFajr];
                timePeriod = "Sebelum Subuh";
            } else if (currentHour >= 4.5 && currentHour < 6) {
                currentIbadah = [...ibadahData.fajr];
                timePeriod = "Subuh";
            } else if (currentHour >= 6 && currentHour < 10.5) {
                currentIbadah = [...ibadahData.morning];
                timePeriod = "Pagi";
            } else if (currentHour >= 10.5 && currentHour < 15.5) {
                currentIbadah = [...ibadahData.dhuhr];
                timePeriod = "Dzuhur";
            } else if (currentHour >= 15.5 && currentHour < 18) {
                currentIbadah = [...ibadahData.asr];
                timePeriod = "Ashar";
            } else if (currentHour >= 18 && currentHour < 19.5) {
                currentIbadah = [...ibadahData.maghrib];
                timePeriod = "Maghrib";
            } else {
                currentIbadah = [...ibadahData.isha];
                timePeriod = "Isya";
            }
            
            // Tambahkan ibadah yang selalu bisa dilakukan
            currentIbadah = [...alwaysIbadah, ...currentIbadah];
            
            // Hapus duplikat berdasarkan id
            const uniqueIbadah = [];
            const seenIds = new Set();
            
            currentIbadah.forEach(ibadah => {
                if (!seenIds.has(ibadah.id)) {
                    seenIds.add(ibadah.id);
                    uniqueIbadah.push(ibadah);
                }
            });
            
            // Update highlight box
            updateHighlightBox(currentTimeStr);
            
            // Tampilkan ibadah
            displayIbadah(uniqueIbadah);
            
            // Update ibadah berikutnya
            updateNextIbadah(currentTimeStr);
            
            // Update progress
            updateProgress();
        }
        
        // Update tanggal Hijriyah menggunakan API dari IslamicFinder
        async function updateHijriDate(gregorianDate) {
            const hijriElement = document.getElementById('hijri');
            
            // Cek apakah sudah ada data hijriah di localStorage untuk hari ini
            const todayStr = gregorianDate.toDateString();
            const storedHijri = JSON.parse(localStorage.getItem('hijriDate'));
            
            if (storedHijri && storedHijri.date === todayStr) {
                // Gunakan data yang sudah tersimpan
                hijriElement.textContent = storedHijri.hijri;
                return;
            }
            
            try {
                // Format tanggal untuk API (DD-MM-YYYY)
                const day = gregorianDate.getDate().toString().padStart(2, '0');
                const month = (gregorianDate.getMonth() + 1).toString().padStart(2, '0');
                const year = gregorianDate.getFullYear();
                const apiDate = `${day}-${month}-${year}`;
                
                // Gunakan IslamicFinder API (atau alternatif)
                // IslamicFinder API memerlukan API key, jadi kita gunakan alternatif
                const response = await fetch(`https://api.aladhan.com/v1/gToH?date=${apiDate}`);
                const data = await response.json();
                
                if (data.code === 200 && data.data) {
                    const hijri = data.data.hijri;
                    const hijriDateStr = `${hijri.day} ${hijri.month.en} ${hijri.year} H`;
                    
                    // Simpan ke localStorage
                    localStorage.setItem('hijriDate', JSON.stringify({
                        date: todayStr,
                        hijri: hijriDateStr
                    }));
                    
                    hijriElement.textContent = hijriDateStr;
                } else {
                    throw new Error('Data hijriah tidak ditemukan');
                }
            } catch (error) {
                console.error('Gagal mengambil data hijriah:', error);
                // Fallback ke perhitungan sederhana
                const hijriMonths = ['Muharram', 'Safar', 'Rabiul Awal', 'Rabiul Akhir', 'Jumadil Awal', 'Jumadil Akhir', 
                                    'Rajab', 'Sya\'ban', 'Ramadhan', 'Syawal', 'Dzulqa\'dah', 'Dzulhijjah'];
                
                const hijriYear = 1447;
                const hijriMonth = hijriMonths[6]; // Rajab
                const hijriDay = 20 + Math.floor(gregorianDate.getDate() / 2);
                
                hijriElement.textContent = `${hijriDay} ${hijriMonth} ${hijriYear} H`;
            }
        }
        
        // Update highlight box berdasarkan waktu
        function updateHighlightBox(currentTime) {
            const highlightBox = document.getElementById('highlight-box');
            let showHighlight = false;
            
            for (const highlight of highlightTimes) {
                if (currentTime >= highlight.start && currentTime <= highlight.end) {
                    document.getElementById('highlight-title').textContent = highlight.title;
                    document.getElementById('highlight-text').textContent = highlight.text;
                    showHighlight = true;
                    break;
                }
            }
            
            highlightBox.style.display = showHighlight ? 'block' : 'none';
        }
        
        // Tampilkan daftar ibadah
        function displayIbadah(ibadahList) {
            const container = document.getElementById('ibadah-container');
            container.innerHTML = '';
            
            ibadahList.forEach((ibadah, index) => {
                const isChecked = completedIbadah.includes(ibadah.id);
                const isImportant = ibadah.important || false;
                const isUrgent = ibadah.urgent || false;
                
                let className = 'ibadah-item';
                if (isImportant) className += ' important';
                if (isUrgent) className += ' urgent';
                
                const ibadahElement = document.createElement('div');
                ibadahElement.className = className;
                ibadahElement.innerHTML = `
                    <div class="ibadah-number">${index + 1}</div>
                    <div class="ibadah-info">
                        <div class="ibadah-name">${ibadah.name}</div>
                        <div class="ibadah-time">
                            <i class="far fa-clock"></i> ${ibadah.time}
                        </div>
                    </div>
                    <div class="checkmark ${isChecked ? 'checked' : ''}" data-id="${ibadah.id}"></div>
                `;
                
                container.appendChild(ibadahElement);
            });
            
            // Tambahkan event listener untuk checkmark
            document.querySelectorAll('.checkmark').forEach(checkmark => {
                checkmark.addEventListener('click', function() {
                    const ibadahId = parseInt(this.getAttribute('data-id'));
                    toggleIbadah(ibadahId, this);
                });
            });
        }
        
        // Toggle status ibadah (centang/tidak)
        function toggleIbadah(ibadahId, element) {
            const index = completedIbadah.indexOf(ibadahId);
            
            if (index === -1) {
                // Centang ibadah
                completedIbadah.push(ibadahId);
                element.classList.add('checked');
                
                // Tampilkan notifikasi
                showNotification('Ibadah telah dicentang!');
            } else {
                // Hapus centang
                completedIbadah.splice(index, 1);
                element.classList.remove('checked');
            }
            
            // Simpan ke localStorage
            localStorage.setItem('completedIbadah', JSON.stringify(completedIbadah));
            
            // Update progress
            updateProgress();
        }
        
        // Tampilkan notifikasi
        function showNotification(message) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }
        
        // Update ibadah berikutnya
        function updateNextIbadah(currentTime) {
            const container = document.getElementById('next-ibadah-container');
            container.innerHTML = '';
            
            // Cari ibadah berikutnya
            let nextIbadah = null;
            for (const ibadah of nextIbadahSchedule) {
                if (ibadah.time > currentTime) {
                    nextIbadah = ibadah;
                    break;
                }
            }
            
            // Jika tidak ada, ambil ibadah pertama besok
            if (!nextIbadah) {
                nextIbadah = nextIbadahSchedule[0];
            }
            
            // Tampilkan ibadah berikutnya
            const nextElement = document.createElement('div');
            nextElement.className = 'next-item';
            nextElement.innerHTML = `
                <div class="next-time">${nextIbadah.time}</div>
                <div class="next-name">${nextIbadah.name}</div>
                <div style="color: #666; font-size: 0.85rem;">${nextIbadah.period}</div>
            `;
            
            container.appendChild(nextElement);
            
            // Tampilkan 2 ibadah berikutnya
            const currentIndex = nextIbadahSchedule.indexOf(nextIbadah);
            const nextIndex = (currentIndex + 1) % nextIbadahSchedule.length;
            const nextNextIbadah = nextIbadahSchedule[nextIndex];
            
            const nextNextElement = document.createElement('div');
            nextNextElement.className = 'next-item';
            nextNextElement.innerHTML = `
                <div class="next-time">${nextNextIbadah.time}</div>
                <div class="next-name">${nextNextIbadah.name}</div>
                <div style="color: #666; font-size: 0.85rem;">${nextNextIbadah.period}</div>
            `;
            
            container.appendChild(nextNextElement);
        }
        
        // Update progress bar
        function updateProgress() {
            const totalIbadah = document.querySelectorAll('.ibadah-item').length;
            const completed = completedIbadah.length;
            
            const percentage = totalIbadah > 0 ? Math.round((completed / totalIbadah) * 100) : 0;
            
            document.getElementById('progress-fill').style.width = `${percentage}%`;
            document.getElementById('progress-fill').textContent = `${percentage}%`;
            document.getElementById('completed').textContent = completed;
            document.getElementById('total').textContent = totalIbadah;
        }
        
        // Dapatkan lokasi pengguna
        function getLocation() {
            const locationElement = document.getElementById('location');
            const locationBtn = document.getElementById('get-location-btn');
            
            locationElement.innerHTML = '<span class="loading location-loading">Mendapatkan lokasi...</span>';
            locationBtn.disabled = true;
            locationBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Memuat...';
            
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    async function(position) {
                        try {
                            // Gunakan OpenStreetMap Nominatim API untuk reverse geocoding
                            const response = await fetch(
                                `https://nominatim.openstreetmap.org/reverse?format=json&lat=${position.coords.latitude}&lon=${position.coords.longitude}`
                            );
                            const data = await response.json();
                            
                            if (data.address) {
                                const city = data.address.city || data.address.town || data.address.village || data.address.county || '';
                                const country = data.address.country || '';
                                locationElement.textContent = `${city}, ${country}`;
                                locationElement.className = 'location-text';
                                
                                // Simpan lokasi ke localStorage
                                localStorage.setItem('userLocation', JSON.stringify({
                                    city: city,
                                    country: country,
                                    lat: position.coords.latitude,
                                    lon: position.coords.longitude
                                }));
                            } else {
                                locationElement.textContent = "Lokasi ditemukan";
                                locationElement.className = 'location-text';
                            }
                        } catch (error) {
                            console.error("Error reverse geocoding:", error);
                            locationElement.textContent = "Lokasi Anda";
                            locationElement.className = 'location-text';
                        }
                        
                        locationBtn.disabled = false;
                        locationBtn.innerHTML = '<i class="fas fa-location-crosshairs"></i> Dapatkan Lokasi';
                        showNotification('Lokasi berhasil diperbarui!');
                    },
                    function(error) {
                        console.log("Tidak bisa mendapatkan lokasi:", error);
                        locationElement.textContent = "Lokasi tidak tersedia";
                        locationElement.className = 'location-text';
                        
                        locationBtn.disabled = false;
                        locationBtn.innerHTML = '<i class="fas fa-location-crosshairs"></i> Coba Lagi';
                        showNotification('Gagal mendapatkan lokasi. Periksa izin lokasi.');
                    },
                    { timeout: 10000 }
                );
            } else {
                locationElement.textContent = "Geolocation tidak didukung";
                locationElement.className = 'location-text';
                locationBtn.disabled = true;
                locationBtn.innerHTML = '<i class="fas fa-times-circle"></i> Tidak didukung';
            }
        }
        
        // Inisialisasi
        document.addEventListener('DOMContentLoaded', function() {
            // Update waktu setiap detik
            updateTime();
            setInterval(updateTime, 1000);
            
            // Event listener untuk tombol lokasi
            document.getElementById('get-location-btn').addEventListener('click', getLocation);
            
            // Cek apakah ada lokasi yang disimpan di localStorage
            const savedLocation = JSON.parse(localStorage.getItem('userLocation'));
            if (savedLocation) {
                document.getElementById('location').textContent = `${savedLocation.city}, ${savedLocation.country}`;
            }
            
            // Load tanggal hijriah
            updateHijriDate(new Date());
        });
    </script>
</body>
</html>